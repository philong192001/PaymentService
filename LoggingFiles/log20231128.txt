2023-11-28 16:25:49.015 +07:00  INF  Now listening on: https://localhost:7116
2023-11-28 16:25:49.047 +07:00  INF  Now listening on: http://localhost:5271
2023-11-28 16:25:49.049 +07:00  INF  Application started. Press Ctrl+C to shut down.
2023-11-28 16:25:49.050 +07:00  INF  Hosting environment: Development
2023-11-28 16:25:49.050 +07:00  INF  Content root path: D:\longpv2\.NetCore-Microservices\PaymentService\PaymentService\Payment.App\
2023-11-28 16:25:49.752 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/index.html - -
2023-11-28 16:25:50.211 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - -
2023-11-28 16:25:50.216 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/index.html - - - 200 - text/html;charset=utf-8 467.6160ms
2023-11-28 16:25:50.227 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - - - 200 12354 application/javascript;+charset=utf-8 11.5049ms
2023-11-28 16:25:50.300 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_vs/browserLink - -
2023-11-28 16:25:50.369 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 68.4161ms
2023-11-28 16:25:50.535 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - -
2023-11-28 16:25:50.817 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 282.6777ms
2023-11-28 16:26:49.897 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169
2023-11-28 16:26:49.908 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:26:49.910 +07:00  INF  Executing endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:26:49.929 +07:00  INF  Route matched with {action = "GetQR", controller = "OnePay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.OnePay.OnePayRequest) on controller Payment.App.Controllers.OnePayController (Payment.App).
2023-11-28 16:26:50.877 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:26:51.717 +07:00  INF  Executed DbCommand (58ms) [Parameters=[@__onePayRequest_CompanyId_0='?' (DbType = Int32), @__ToString_1='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__onePayRequest_CompanyId_0) AND ([q].[PaymentType] = @__ToString_1)
2023-11-28 16:26:51.789 +07:00  ERR  An exception occurred while iterating over the results of a query for context type 'Payment.App.Data.PaymentDbContext'.
System.Data.SqlTypes.SqlNullValueException: Data is Null. This method or property cannot be called on Null values.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.Initialize(DbDataReader reader, IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.Initialize(IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass31_0`2.<Execute>b__0(DbContext context, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()System.Data.SqlTypes.SqlNullValueException: Data is Null. This method or property cannot be called on Null values.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.Initialize(DbDataReader reader, IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.Initialize(IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass31_0`2.<Execute>b__0(DbContext context, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()

2023-11-28 16:26:51.848 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:26:51.856 +07:00  INF  Executed action Payment.App.Controllers.OnePayController.GetQR (Payment.App) in 1918.6475ms
2023-11-28 16:26:51.857 +07:00  INF  Executed endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:26:51.864 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169 - 400 - text/plain;+charset=utf-8 1967.2015ms
2023-11-28 16:27:46.875 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169
2023-11-28 16:27:46.886 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:27:46.886 +07:00  INF  Executing endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:27:46.886 +07:00  INF  Route matched with {action = "GetQR", controller = "OnePay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.OnePay.OnePayRequest) on controller Payment.App.Controllers.OnePayController (Payment.App).
2023-11-28 16:27:56.628 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:27:56.651 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@__onePayRequest_CompanyId_0='?' (DbType = Int32), @__ToString_1='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__onePayRequest_CompanyId_0) AND ([q].[PaymentType] = @__ToString_1)
2023-11-28 16:27:56.652 +07:00  ERR  An exception occurred while iterating over the results of a query for context type 'Payment.App.Data.PaymentDbContext'.
System.Data.SqlTypes.SqlNullValueException: Data is Null. This method or property cannot be called on Null values.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.Initialize(DbDataReader reader, IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.Initialize(IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass31_0`2.<Execute>b__0(DbContext context, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()System.Data.SqlTypes.SqlNullValueException: Data is Null. This method or property cannot be called on Null values.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Int32()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadInt(DbDataReader reader, Int32 ordinal, ReaderColumn column)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.ReadRow()
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.BufferedDataRecord.Initialize(DbDataReader reader, IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Query.Internal.BufferedDataReader.Initialize(IReadOnlyList`1 columns)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass31_0`2.<Execute>b__0(DbContext context, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementation[TState,TResult](Func`3 operation, Func`3 verifySucceeded, TState state)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()

2023-11-28 16:28:04.476 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:28:04.476 +07:00  INF  Executed action Payment.App.Controllers.OnePayController.GetQR (Payment.App) in 17589.7785ms
2023-11-28 16:28:04.476 +07:00  INF  Executed endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:28:04.476 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169 - 400 - text/plain;+charset=utf-8 17600.9616ms
2023-11-28 16:29:31.420 +07:00  INF  Now listening on: https://localhost:7116
2023-11-28 16:29:31.457 +07:00  INF  Now listening on: http://localhost:5271
2023-11-28 16:29:31.460 +07:00  INF  Application started. Press Ctrl+C to shut down.
2023-11-28 16:29:31.460 +07:00  INF  Hosting environment: Development
2023-11-28 16:29:31.460 +07:00  INF  Content root path: D:\longpv2\.NetCore-Microservices\PaymentService\PaymentService\Payment.App\
2023-11-28 16:29:32.115 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/index.html - -
2023-11-28 16:29:32.391 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - -
2023-11-28 16:29:32.398 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/index.html - - - 200 - text/html;charset=utf-8 288.5665ms
2023-11-28 16:29:32.398 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - - - 200 12354 application/javascript;+charset=utf-8 5.5629ms
2023-11-28 16:29:32.459 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_vs/browserLink - -
2023-11-28 16:29:32.489 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 29.3214ms
2023-11-28 16:29:32.695 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - -
2023-11-28 16:29:32.834 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 139.1111ms
2023-11-28 16:33:32.393 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169
2023-11-28 16:33:32.405 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:33:32.408 +07:00  INF  Executing endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:33:32.425 +07:00  INF  Route matched with {action = "GetQR", controller = "OnePay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.OnePay.OnePayRequest) on controller Payment.App.Controllers.OnePayController (Payment.App).
2023-11-28 16:33:38.921 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:33:39.807 +07:00  INF  Executed DbCommand (54ms) [Parameters=[@__onePayRequest_CompanyId_0='?' (DbType = Int32), @__ToString_1='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__onePayRequest_CompanyId_0) AND ([q].[PaymentType] = @__ToString_1)
2023-11-28 16:33:49.503 +07:00  INF  Start processing HTTP request POST "https://mtf.onepay.vn/paygate/vpcpay.op"
2023-11-28 16:33:49.505 +07:00  INF  Sending HTTP request POST "https://mtf.onepay.vn/paygate/vpcpay.op"
2023-11-28 16:33:49.729 +07:00  INF  Received HTTP response headers after 219.752ms - 200
2023-11-28 16:33:49.730 +07:00  INF  End processing HTTP request after 234.7707ms - 200
2023-11-28 16:34:28.259 +07:00  INF  Executing NotFoundObjectResult, writing value of type 'Payment.App.DTOs.ResponseAppDTO`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-28 16:34:28.279 +07:00  INF  Executed action Payment.App.Controllers.OnePayController.GetQR (Payment.App) in 55846.2768ms
2023-11-28 16:34:28.279 +07:00  INF  Executed endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:34:28.288 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169 - 404 - application/json;+charset=utf-8 55894.5915ms
2023-11-28 16:34:31.293 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169
2023-11-28 16:34:31.295 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:34:31.295 +07:00  INF  Executing endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:34:31.295 +07:00  INF  Route matched with {action = "GetQR", controller = "OnePay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.OnePay.OnePayRequest) on controller Payment.App.Controllers.OnePayController (Payment.App).
2023-11-28 16:34:35.116 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:34:35.143 +07:00  INF  Executed DbCommand (9ms) [Parameters=[@__onePayRequest_CompanyId_0='?' (DbType = Int32), @__ToString_1='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__onePayRequest_CompanyId_0) AND ([q].[PaymentType] = @__ToString_1)
2023-11-28 16:34:51.249 +07:00  INF  Start processing HTTP request POST "https://mtf.onepay.vn/paygate/vpcpay.op"
2023-11-28 16:34:51.250 +07:00  INF  Sending HTTP request POST "https://mtf.onepay.vn/paygate/vpcpay.op"
2023-11-28 16:34:51.435 +07:00  INF  Received HTTP response headers after 184.2252ms - 200
2023-11-28 16:34:51.435 +07:00  INF  End processing HTTP request after 185.498ms - 200
2023-11-28 16:34:51.448 +07:00  INF  Start processing HTTP request POST "https://mtf.onepay.vn/paygate/api/v1/invoices/INV-L3UMFVYMXM565NVZ/qrs"
2023-11-28 16:34:51.448 +07:00  INF  Sending HTTP request POST "https://mtf.onepay.vn/paygate/api/v1/invoices/INV-L3UMFVYMXM565NVZ/qrs"
2023-11-28 16:34:51.469 +07:00  INF  Received HTTP response headers after 21.2961ms - 201
2023-11-28 16:34:51.469 +07:00  INF  End processing HTTP request after 21.6058ms - 201
2023-11-28 16:34:51.602 +07:00  INF  Response string QRCode : Payment.App.Models.OnePay.OnePayQrResponse
2023-11-28 16:34:51.602 +07:00  INF   Value ID : INV-L3UMFVYMXM565NVZ -- pathImage : D:\longpv2\.NetCore-Microservices\PaymentService\PaymentService\Image\OnePay\7f33eee2-b0ff-442c-926b-66057af48a6f.png -- Query : ?id=INV-L3UMFVYMXM565NVZ&locale=vi
2023-11-28 16:34:52.209 +07:00  INF  Executed DbCommand (118ms) [Parameters=[@p0='?' (DbType = Double), @p1='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?' (Size = 200), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 50), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 500), @p12='?' (Size = 50), @p13='?' (Size = 200), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Size = 200), @p17='?' (DbType = Int32), @p18='?' (Size = 50), @p19='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [QRPay.Transaction] ([Amount], [BookId], [CompanyId], [CustomerName], [DateCreateQR], [DatePay], [DriverCode], [DriverName], [ErrorCode], [ExpiredFee], [FeeMonth], [Message], [Mobile], [PartnerTransId], [PaymentType], [PrivateCode], [QRCode], [Status], [TripId], [VehiclePlate])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT [TransId]
FROM [QRPay.Transaction]
WHERE @@ROWCOUNT = 1 AND [TransId] = scope_identity();
2023-11-28 16:34:52.256 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.DTOs.ResponseAppDTO`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-28 16:34:52.257 +07:00  INF  Executed action Payment.App.Controllers.OnePayController.GetQR (Payment.App) in 20961.647ms
2023-11-28 16:34:52.257 +07:00  INF  Executed endpoint 'Payment.App.Controllers.OnePayController.GetQR (Payment.App)'
2023-11-28 16:34:52.257 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/OnePay/GetQR application/json 169 - 200 - application/json;+charset=utf-8 20964.0897ms
2023-11-28 16:38:36.962 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/OnePay/NotiPayment application/json 285
2023-11-28 16:38:36.966 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:38:36.969 +07:00  INF  Executing endpoint 'Payment.App.Controllers.OnePayController.NotiPayment (Payment.App)'
2023-11-28 16:38:36.972 +07:00  INF  Route matched with {action = "NotiPayment", controller = "OnePay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult NotiPayment(Payment.App.Models.OnePay.NotiOnepayRequest) on controller Payment.App.Controllers.OnePayController (Payment.App).
2023-11-28 16:38:37.023 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:38:37.042 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@__notiOnepayRequest_vpc_OrderInfo_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__notiOnepayRequest_vpc_OrderInfo_0
2023-11-28 16:38:37.048 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'Payment.App.DTOs.ResponseAppDTO`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-28 16:38:37.049 +07:00  INF  Executed action Payment.App.Controllers.OnePayController.NotiPayment (Payment.App) in 76.0559ms
2023-11-28 16:38:37.049 +07:00  INF  Executed endpoint 'Payment.App.Controllers.OnePayController.NotiPayment (Payment.App)'
2023-11-28 16:38:37.049 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/OnePay/NotiPayment application/json 285 - 400 - application/json;+charset=utf-8 87.2313ms
2023-11-28 16:41:19.423 +07:00  INF  Now listening on: https://localhost:7116
2023-11-28 16:41:19.455 +07:00  INF  Now listening on: http://localhost:5271
2023-11-28 16:41:19.458 +07:00  INF  Application started. Press Ctrl+C to shut down.
2023-11-28 16:41:19.458 +07:00  INF  Hosting environment: Development
2023-11-28 16:41:19.458 +07:00  INF  Content root path: D:\longpv2\.NetCore-Microservices\PaymentService\PaymentService\Payment.App\
2023-11-28 16:41:20.083 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/index.html - -
2023-11-28 16:41:20.385 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/index.html - - - 200 - text/html;charset=utf-8 303.9972ms
2023-11-28 16:41:20.406 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - -
2023-11-28 16:41:20.416 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - - - 200 12354 application/javascript;+charset=utf-8 10.1846ms
2023-11-28 16:41:20.487 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_vs/browserLink - -
2023-11-28 16:41:20.529 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 41.5759ms
2023-11-28 16:41:20.692 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - -
2023-11-28 16:41:20.861 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 168.9714ms
2023-11-28 16:41:51.310 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/OnePay/NotiPayment application/json 288
2023-11-28 16:41:51.319 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:41:51.322 +07:00  INF  Executing endpoint 'Payment.App.Controllers.OnePayController.NotiPayment (Payment.App)'
2023-11-28 16:41:51.340 +07:00  INF  Route matched with {action = "NotiPayment", controller = "OnePay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult NotiPayment(Payment.App.Models.OnePay.NotiOnepayRequest) on controller Payment.App.Controllers.OnePayController (Payment.App).
2023-11-28 16:41:52.096 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:41:52.912 +07:00  INF  Executed DbCommand (75ms) [Parameters=[@__notiOnepayRequest_vpc_OrderInfo_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE ([q].[TripId] = @__notiOnepayRequest_vpc_OrderInfo_0) AND ([q].[Status] = 0)
2023-11-28 16:41:53.065 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@__notiOnepayRequest_vpc_Merchant_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[UrlCreateQR]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[MasterMerchant] = @__notiOnepayRequest_vpc_Merchant_0) AND ([q].[PaymentType] = N'OnePay')
2023-11-28 16:41:53.078 +07:00  INF  Start processing HTTP request POST "https://mtf.onepay.vn/paygate/vpcpay.op"
2023-11-28 16:41:53.079 +07:00  INF  Sending HTTP request POST "https://mtf.onepay.vn/paygate/vpcpay.op"
2023-11-28 16:41:53.168 +07:00  INF  Received HTTP response headers after 85.5574ms - 415
2023-11-28 16:41:53.170 +07:00  INF  End processing HTTP request after 96.6513ms - 415
2023-11-28 16:41:53.279 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (Size = 200), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [PartnerTransId] = @p0, [Status] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 16:41:53.303 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.DTOs.ResponseAppDTO`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-28 16:41:53.317 +07:00  INF  Executed action Payment.App.Controllers.OnePayController.NotiPayment (Payment.App) in 1971.907ms
2023-11-28 16:41:53.317 +07:00  INF  Executed endpoint 'Payment.App.Controllers.OnePayController.NotiPayment (Payment.App)'
2023-11-28 16:41:53.324 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/OnePay/NotiPayment application/json 288 - 200 - application/json;+charset=utf-8 2014.2468ms
2023-11-28 16:45:43.257 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 119
2023-11-28 16:45:43.260 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:45:43.260 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:45:43.261 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:45:43.270 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:45:43.287 +07:00  INF  Executed DbCommand (10ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:45:43.325 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=750000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=355333"
2023-11-28 16:45:43.325 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=750000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=355333"
2023-11-28 16:45:43.722 +07:00  INF  Received HTTP response headers after 397.0508ms - 401
2023-11-28 16:45:43.722 +07:00  INF  End processing HTTP request after 397.4731ms - 401
2023-11-28 16:45:43.731 +07:00  INF  Start processing HTTP request POST "https://qrtool.vnpay.vn/authentication/oauth/token?grant_type=client_credentials&scope=read"
2023-11-28 16:45:43.731 +07:00  INF  Sending HTTP request POST "https://qrtool.vnpay.vn/authentication/oauth/token?grant_type=client_credentials&scope=read"
2023-11-28 16:45:43.991 +07:00  INF  Received HTTP response headers after 259.2402ms - 200
2023-11-28 16:45:43.991 +07:00  INF  End processing HTTP request after 259.8556ms - 200
2023-11-28 16:45:44.002 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=750000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=355333"
2023-11-28 16:45:44.002 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=750000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=355333"
2023-11-28 16:45:45.470 +07:00  INF  Received HTTP response headers after 1467.6635ms - 200
2023-11-28 16:45:45.470 +07:00  INF  End processing HTTP request after 1468.4839ms - 200
2023-11-28 16:45:46.092 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:45:46.092 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 2831.0639ms
2023-11-28 16:45:46.092 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:45:46.092 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 119 - 400 - text/plain;+charset=utf-8 2837.8030ms
2023-11-28 16:45:56.662 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 119
2023-11-28 16:45:56.663 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:45:56.663 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:45:56.664 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:45:56.703 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:45:56.719 +07:00  INF  Executed DbCommand (8ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:45:56.720 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=750000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=355333"
2023-11-28 16:45:56.720 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=750000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=355333"
2023-11-28 16:45:57.774 +07:00  INF  Received HTTP response headers after 1054.4496ms - 200
2023-11-28 16:45:57.774 +07:00  INF  End processing HTTP request after 1054.7409ms - 200
2023-11-28 16:45:58.054 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:45:58.054 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 1390.5719ms
2023-11-28 16:45:58.054 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:45:58.054 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 119 - 400 - text/plain;+charset=utf-8 1392.6040ms
2023-11-28 16:48:01.915 +07:00  INF  Now listening on: https://localhost:7116
2023-11-28 16:48:01.949 +07:00  INF  Now listening on: http://localhost:5271
2023-11-28 16:48:01.952 +07:00  INF  Application started. Press Ctrl+C to shut down.
2023-11-28 16:48:01.952 +07:00  INF  Hosting environment: Development
2023-11-28 16:48:01.952 +07:00  INF  Content root path: D:\longpv2\.NetCore-Microservices\PaymentService\PaymentService\Payment.App\
2023-11-28 16:48:02.600 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/index.html - -
2023-11-28 16:48:02.942 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - -
2023-11-28 16:48:02.951 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - - - 200 12354 application/javascript;+charset=utf-8 7.8438ms
2023-11-28 16:48:02.951 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/index.html - - - 200 - text/html;charset=utf-8 353.7991ms
2023-11-28 16:48:03.043 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_vs/browserLink - -
2023-11-28 16:48:03.079 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 36.2823ms
2023-11-28 16:48:03.249 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - -
2023-11-28 16:48:03.481 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 231.6099ms
2023-11-28 16:48:25.876 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 124
2023-11-28 16:48:25.889 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:48:25.892 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:48:25.910 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:48:26.637 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:48:27.430 +07:00  INF  Executed DbCommand (54ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:48:27.554 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4422442k"
2023-11-28 16:48:27.555 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4422442k"
2023-11-28 16:48:27.945 +07:00  INF  Received HTTP response headers after 379.3822ms - 401
2023-11-28 16:48:27.949 +07:00  INF  End processing HTTP request after 400.9538ms - 401
2023-11-28 16:48:27.957 +07:00  INF  Start processing HTTP request POST "https://qrtool.vnpay.vn/authentication/oauth/token?grant_type=client_credentials&scope=read"
2023-11-28 16:48:27.957 +07:00  INF  Sending HTTP request POST "https://qrtool.vnpay.vn/authentication/oauth/token?grant_type=client_credentials&scope=read"
2023-11-28 16:48:28.235 +07:00  INF  Received HTTP response headers after 277.7875ms - 200
2023-11-28 16:48:28.235 +07:00  INF  End processing HTTP request after 278.0117ms - 200
2023-11-28 16:48:28.238 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4422442k"
2023-11-28 16:48:28.239 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4422442k"
2023-11-28 16:48:29.356 +07:00  INF  Received HTTP response headers after 1117.8459ms - 200
2023-11-28 16:48:29.357 +07:00  INF  End processing HTTP request after 1118.1904ms - 200
2023-11-28 16:48:30.042 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:48:30.047 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 4131.3914ms
2023-11-28 16:48:30.047 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:48:30.054 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 124 - 400 - text/plain;+charset=utf-8 4177.7619ms
2023-11-28 16:49:00.217 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 152
2023-11-28 16:49:00.224 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:49:00.224 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:49:00.224 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:49:00.231 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:49:00.250 +07:00  INF  Executed DbCommand (10ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:49:00.251 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D4C4-38F3-4725-A72F-2727KLI98C98"
2023-11-28 16:49:00.251 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D4C4-38F3-4725-A72F-2727KLI98C98"
2023-11-28 16:49:00.502 +07:00  INF  Received HTTP response headers after 250.6084ms - 200
2023-11-28 16:49:00.502 +07:00  INF  End processing HTTP request after 250.9923ms - 200
2023-11-28 16:49:45.104 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:49:45.108 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 44883.0489ms
2023-11-28 16:49:45.113 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:49:45.123 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 152 - 400 - text/plain;+charset=utf-8 44904.0156ms
2023-11-28 16:50:25.423 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 138
2023-11-28 16:50:25.428 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:50:25.431 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:50:25.432 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:50:25.471 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:50:25.487 +07:00  INF  Executed DbCommand (10ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:50:25.487 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D4C4-38F3-4725-A78"
2023-11-28 16:50:25.487 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D4C4-38F3-4725-A78"
2023-11-28 16:50:25.772 +07:00  INF  Received HTTP response headers after 284.3157ms - 200
2023-11-28 16:50:25.772 +07:00  INF  End processing HTTP request after 284.4961ms - 200
2023-11-28 16:50:38.880 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:50:38.880 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 13447.9094ms
2023-11-28 16:50:38.880 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:50:38.884 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 138 - 400 - text/plain;+charset=utf-8 13459.8672ms
2023-11-28 16:50:47.706 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 132
2023-11-28 16:50:47.706 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:50:47.706 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:50:47.706 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:50:47.707 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:50:47.761 +07:00  INF  Executed DbCommand (53ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:50:47.761 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D38F34725A78"
2023-11-28 16:50:47.761 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D38F34725A78"
2023-11-28 16:50:49.615 +07:00  INF  Received HTTP response headers after 1854.5285ms - 200
2023-11-28 16:50:49.616 +07:00  INF  End processing HTTP request after 1854.9272ms - 200
2023-11-28 16:50:49.984 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:50:49.985 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 2278.28ms
2023-11-28 16:50:49.985 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:50:49.985 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 132 - 400 - text/plain;+charset=utf-8 2278.7633ms
2023-11-28 16:51:00.494 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 132
2023-11-28 16:51:00.495 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:51:00.495 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:51:00.495 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:51:00.496 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:51:00.500 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:51:00.500 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D38F34725A78"
2023-11-28 16:51:00.500 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D38F34725A78"
2023-11-28 16:51:01.833 +07:00  INF  Received HTTP response headers after 1333.5345ms - 200
2023-11-28 16:51:01.834 +07:00  INF  End processing HTTP request after 1333.7653ms - 200
2023-11-28 16:51:02.098 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:51:02.098 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 1603.3266ms
2023-11-28 16:51:02.098 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:51:02.098 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 132 - 400 - text/plain;+charset=utf-8 1603.9226ms
2023-11-28 16:51:08.254 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 132
2023-11-28 16:51:08.254 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:51:08.254 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:51:08.255 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:51:13.637 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:51:13.650 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:51:39.064 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D38F34725A78"
2023-11-28 16:51:39.064 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=4588820000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=4C38D38F34725A78"
2023-11-28 16:51:40.425 +07:00  INF  Received HTTP response headers after 1361.0608ms - 200
2023-11-28 16:51:40.425 +07:00  INF  End processing HTTP request after 1361.29ms - 200
2023-11-28 16:54:13.553 +07:00  INF  Now listening on: https://localhost:7116
2023-11-28 16:54:13.588 +07:00  INF  Now listening on: http://localhost:5271
2023-11-28 16:54:13.591 +07:00  INF  Application started. Press Ctrl+C to shut down.
2023-11-28 16:54:13.592 +07:00  INF  Hosting environment: Development
2023-11-28 16:54:13.592 +07:00  INF  Content root path: D:\longpv2\.NetCore-Microservices\PaymentService\PaymentService\Payment.App\
2023-11-28 16:54:14.166 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/index.html - -
2023-11-28 16:54:14.557 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - -
2023-11-28 16:54:14.563 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/index.html - - - 200 - text/html;charset=utf-8 401.7340ms
2023-11-28 16:54:14.564 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_framework/aspnetcore-browser-refresh.js - - - 200 12354 application/javascript;+charset=utf-8 6.3473ms
2023-11-28 16:54:14.652 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/_vs/browserLink - -
2023-11-28 16:54:14.703 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 50.0996ms
2023-11-28 16:54:14.834 +07:00  INF  Request starting HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - -
2023-11-28 16:54:14.979 +07:00  INF  Request finished HTTP/2 GET https://localhost:7116/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 145.3226ms
2023-11-28 16:55:10.848 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 148
2023-11-28 16:55:10.859 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:55:10.861 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:55:10.879 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:55:18.692 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:55:19.544 +07:00  INF  Executed DbCommand (55ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:55:19.663 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=78520000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=LONGAYUASN"
2023-11-28 16:55:19.664 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=78520000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=LONGAYUASN"
2023-11-28 16:55:20.084 +07:00  INF  Received HTTP response headers after 413.599ms - 401
2023-11-28 16:55:20.087 +07:00  INF  End processing HTTP request after 428.2153ms - 401
2023-11-28 16:55:20.093 +07:00  INF  Start processing HTTP request POST "https://qrtool.vnpay.vn/authentication/oauth/token?grant_type=client_credentials&scope=read"
2023-11-28 16:55:20.093 +07:00  INF  Sending HTTP request POST "https://qrtool.vnpay.vn/authentication/oauth/token?grant_type=client_credentials&scope=read"
2023-11-28 16:55:20.287 +07:00  INF  Received HTTP response headers after 193.9112ms - 200
2023-11-28 16:55:20.287 +07:00  INF  End processing HTTP request after 194.1889ms - 200
2023-11-28 16:55:20.291 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=78520000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=LONGAYUASN"
2023-11-28 16:55:20.291 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=78520000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=LONGAYUASN"
2023-11-28 16:55:21.339 +07:00  INF  Received HTTP response headers after 1047.5389ms - 200
2023-11-28 16:55:21.339 +07:00  INF  End processing HTTP request after 1047.9904ms - 200
2023-11-28 16:55:21.923 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'System.String'.
2023-11-28 16:55:21.929 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 11044.1596ms
2023-11-28 16:55:21.929 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:55:21.937 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 148 - 400 - text/plain;+charset=utf-8 11088.7736ms
2023-11-28 16:55:42.577 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 148
2023-11-28 16:55:42.579 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 16:55:42.579 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:55:42.579 +07:00  INF  Route matched with {action = "GetQR", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetQR(Payment.App.Models.VnPay.VnPayQrRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 16:55:45.650 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 16:55:45.662 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@__payQrRequest_CompanyId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE ([q].[CompanyId] = @__payQrRequest_CompanyId_0) AND ([q].[PaymentType] = N'VNPay')
2023-11-28 16:55:45.662 +07:00  INF  Start processing HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=78520000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=LONGAYUASN"
2023-11-28 16:55:45.662 +07:00  INF  Sending HTTP request GET "https://dev-qrtool.vnpaytest.vn/v2/api/gen?Amount=78520000&MerchantCode=0102306702&ImageFormat=png&ImageType=binary&TerminalID=BINHANH1&Height=2048&Width=2048&BillNumber=LONGAYUASN"
2023-11-28 16:55:47.029 +07:00  INF  Received HTTP response headers after 1366.7179ms - 200
2023-11-28 16:55:47.029 +07:00  INF  End processing HTTP request after 1366.9948ms - 200
2023-11-28 16:55:47.499 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Double), @p1='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?' (Size = 200), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 50), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 500), @p12='?' (Size = 50), @p13='?' (Size = 200), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Size = 200), @p17='?' (DbType = Int32), @p18='?' (Size = 50), @p19='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [QRPay.Transaction] ([Amount], [BookId], [CompanyId], [CustomerName], [DateCreateQR], [DatePay], [DriverCode], [DriverName], [ErrorCode], [ExpiredFee], [FeeMonth], [Message], [Mobile], [PartnerTransId], [PaymentType], [PrivateCode], [QRCode], [Status], [TripId], [VehiclePlate])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
SELECT [TransId]
FROM [QRPay.Transaction]
WHERE @@ROWCOUNT = 1 AND [TransId] = scope_identity();
2023-11-28 16:55:47.541 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.DTOs.ResponseAppDTO`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-28 16:55:47.550 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.GetQR (Payment.App) in 4970.7091ms
2023-11-28 16:55:47.550 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.GetQR (Payment.App)'
2023-11-28 16:55:47.550 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/GetQR application/json 148 - 200 - application/json;+charset=utf-8 4972.9112ms
2023-11-28 17:00:37.347 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 447
2023-11-28 17:00:37.354 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:00:37.354 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:00:37.357 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:00:37.381 +07:00  INF  Current Checksum 8e4c23f6e70d78e99a0c9a5cd4f5b5d2 FromString 00|string|LONGAYUASN|string|string|string|string|78520000|string|string|cjNaVAhET34Oysae
2023-11-28 17:00:37.421 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:00:37.442 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:00:37.451 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:00:37.471 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:00:37.477 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:00:37.478 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 121.007ms
2023-11-28 17:00:37.478 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:00:37.479 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 447 - 200 - application/json;+charset=utf-8 131.0249ms
2023-11-28 17:00:53.485 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 447
2023-11-28 17:00:53.485 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:00:53.485 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:00:53.485 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:00:53.486 +07:00  INF  Current Checksum 8e4c23f6e70d78e99a0c9a5cd4f5b5d2 FromString 00|string|LONGAYUASN|string|string|string|string|78520000|string|string|cjNaVAhET34Oysae
2023-11-28 17:00:53.486 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:00:53.491 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:00:53.491 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:00:53.502 +07:00  INF  Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:00:53.511 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:00:53.511 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 25.9961ms
2023-11-28 17:00:53.511 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:00:53.511 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 447 - 200 - application/json;+charset=utf-8 26.8112ms
2023-11-28 17:00:57.421 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 447
2023-11-28 17:00:57.421 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:00:57.421 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:00:57.421 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:00:57.421 +07:00  INF  Current Checksum 8e4c23f6e70d78e99a0c9a5cd4f5b5d2 FromString 00|string|LONGAYUASN|string|string|string|string|78520000|string|string|cjNaVAhET34Oysae
2023-11-28 17:00:57.421 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:00:57.426 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:00:57.426 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:00:57.435 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:00:57.440 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:00:57.440 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 19.5435ms
2023-11-28 17:00:57.440 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:00:57.440 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 447 - 200 - application/json;+charset=utf-8 19.9382ms
2023-11-28 17:01:45.635 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 451
2023-11-28 17:01:45.635 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:01:45.635 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:01:45.637 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:01:45.639 +07:00  INF  Current Checksum 8e4c23f6e70d78e99a0c9a5cd4f5b5d2 FromString 00|string|LONGAYUASN|string|string|string|string|78520000|string|string|cjNaVAhET34Oysae
2023-11-28 17:01:45.640 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:01:45.643 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:01:45.643 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:01:45.651 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:01:45.656 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:01:45.656 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 17.6192ms
2023-11-28 17:01:45.656 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:01:45.656 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 451 - 200 - application/json;+charset=utf-8 21.2570ms
2023-11-28 17:01:46.970 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 451
2023-11-28 17:01:46.970 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:01:46.970 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:01:46.970 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:01:46.971 +07:00  INF  Current Checksum 8e4c23f6e70d78e99a0c9a5cd4f5b5d2 FromString 00|string|LONGAYUASN|string|string|string|string|78520000|string|string|cjNaVAhET34Oysae
2023-11-28 17:01:46.971 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:01:46.975 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:01:46.975 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:01:46.980 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:01:46.984 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:01:46.984 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 13.3837ms
2023-11-28 17:01:46.984 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:01:46.984 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 451 - 200 - application/json;+charset=utf-8 13.9217ms
2023-11-28 17:23:51.008 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 521
2023-11-28 17:23:51.010 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:23:51.012 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:23:51.015 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:23:51.020 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2023-11-28 17:23:51.023 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 6.9222ms
2023-11-28 17:23:51.023 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:23:51.023 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 521 - 400 - application/problem+json;+charset=utf-8 14.4157ms
2023-11-28 17:24:31.234 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:24:31.235 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:24:31.235 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:24:31.235 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:24:31.243 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:24:31.243 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:24:31.285 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:24:31.285 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:24:31.297 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:24:31.304 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:24:31.305 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 69.2676ms
2023-11-28 17:24:31.305 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:24:31.305 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 200 - application/json;+charset=utf-8 71.2582ms
2023-11-28 17:25:02.399 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:25:02.400 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:25:02.401 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:25:02.402 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:25:02.403 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:25:02.403 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:25:02.407 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:25:02.408 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:25:02.413 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:25:02.417 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:25:02.417 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 14.6112ms
2023-11-28 17:25:02.417 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:25:02.417 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 200 - application/json;+charset=utf-8 18.8462ms
2023-11-28 17:25:29.155 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 514
2023-11-28 17:25:29.155 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:25:29.156 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:25:29.157 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:25:29.159 +07:00  INF  Current Checksum 29023dbe0210c4dbc1a42c201fdc07b8 FromString 00|1|LONGAYUASN1|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:25:29.159 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:25:29.167 +07:00  INF  Executed DbCommand (7ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:25:29.167 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN1","amount":"78520000"}}
2023-11-28 17:25:41.401 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:25:43.671 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 14513.4747ms
2023-11-28 17:25:43.674 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:25:43.676 +07:00  ERR  An unhandled exception has occurred while executing the request.System.NullReferenceException: Object reference not set to an instance of an object.
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
   at lambda_method341(Closure , Object , Object[] )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)

2023-11-28 17:25:43.702 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 514 - 500 - text/plain;+charset=utf-8 14547.5174ms
2023-11-28 17:25:50.466 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 514
2023-11-28 17:25:50.467 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:25:50.467 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:25:50.468 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:26:08.602 +07:00  INF  Current Checksum 29023dbe0210c4dbc1a42c201fdc07b8 FromString 00|1|LONGAYUASN1|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:26:11.981 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:26:11.984 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:26:11.985 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN1","amount":"78520000"}}
2023-11-28 17:26:13.049 +07:00  INF  Executed DbCommand (8ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:26:14.306 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 23837.8781ms
2023-11-28 17:26:14.306 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:26:14.306 +07:00  ERR  An unhandled exception has occurred while executing the request.System.NullReferenceException: Object reference not set to an instance of an object.
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
   at lambda_method367(Closure , Object , Object[] )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)

2023-11-28 17:26:14.308 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 514 - 500 - text/plain;+charset=utf-8 23841.3187ms
2023-11-28 17:26:21.730 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:26:21.732 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:26:21.732 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:26:21.732 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:26:33.871 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:26:35.919 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:26:35.930 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:27:31.868 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:27:31.885 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:27:31.893 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:27:31.894 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 70162.2328ms
2023-11-28 17:27:31.894 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:27:31.894 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 200 - application/json;+charset=utf-8 70163.8450ms
2023-11-28 17:27:36.505 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:27:36.505 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:27:36.505 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:27:36.505 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:27:43.366 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:27:44.240 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:27:44.269 +07:00  INF  Executed DbCommand (20ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:28:01.094 +07:00  ERR  RES {"code":"09","message":"QR h\u1EBFt h\u1EA1n thanh to\u00E1n","data":{"txnId":null,"amount":"78520000"}}
2023-11-28 17:28:01.107 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:28:01.112 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:28:01.112 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 24607.2115ms
2023-11-28 17:28:01.112 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:28:01.112 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 200 - application/json;+charset=utf-8 24607.6793ms
2023-11-28 17:28:31.532 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:28:31.532 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:28:31.532 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:28:31.532 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:28:47.286 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:28:47.300 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:28:47.315 +07:00  INF  Executed DbCommand (9ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:28:47.316 +07:00  ERR  RES {"code":"09","message":"QR h\u1EBFt h\u1EA1n thanh to\u00E1n","data":{"txnId":null,"amount":"78520000"}}
2023-11-28 17:28:47.335 +07:00  INF  Executed DbCommand (12ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:28:47.355 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:28:47.355 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 15823.1036ms
2023-11-28 17:28:47.355 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:28:47.355 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 200 - application/json;+charset=utf-8 15823.5283ms
2023-11-28 17:29:30.482 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:29:30.482 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:29:30.482 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:29:30.482 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:29:33.111 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:29:33.118 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:29:33.124 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:29:47.383 +07:00  ERR  RES {"code":"09","message":"QR h\u1EBFt h\u1EA1n thanh to\u00E1n","data":{"txnId":null,"amount":"78520000"}}
2023-11-28 17:29:47.391 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:29:47.395 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:29:47.396 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 16913.4679ms
2023-11-28 17:29:47.396 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:29:47.396 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 200 - application/json;+charset=utf-8 16913.9742ms
2023-11-28 17:30:16.923 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:30:16.923 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:30:16.923 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:30:16.923 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:30:21.749 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:30:21.749 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:30:21.754 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:30:21.762 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:30:21.796 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@__request_MerchantCode_0='?' (Size = 50), @__request_TerminalId_1='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[UrlCreateQR]
FROM [QRPay.Terminals] AS [q]
WHERE (([q].[PaymentType] = N'VNPay') AND ([q].[MasterMerchant] = @__request_MerchantCode_0)) AND ([q].[AccessCode] = @__request_TerminalId_1)
2023-11-28 17:30:21.818 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TerminalId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [QRPay.Terminals] AS [q]
        WHERE [q].[TerminalCode] = @__request_TerminalId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2023-11-28 17:30:21.842 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:30:21.853 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@p20='?' (DbType = Int64), @p0='?' (DbType = Double), @p1='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?' (Size = 200), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 50), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 500), @p12='?' (Size = 50), @p13='?' (Size = 200), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Size = 200), @p17='?' (DbType = Int32), @p18='?' (Size = 50), @p19='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [Amount] = @p0, [BookId] = @p1, [CompanyId] = @p2, [CustomerName] = @p3, [DateCreateQR] = @p4, [DatePay] = @p5, [DriverCode] = @p6, [DriverName] = @p7, [ErrorCode] = @p8, [ExpiredFee] = @p9, [FeeMonth] = @p10, [Message] = @p11, [Mobile] = @p12, [PartnerTransId] = @p13, [PaymentType] = @p14, [PrivateCode] = @p15, [QRCode] = @p16, [Status] = @p17, [TripId] = @p18, [VehiclePlate] = @p19
WHERE [TransId] = @p20;
SELECT @@ROWCOUNT;
2023-11-28 17:30:21.857 +07:00  ERR  Li Update Tran VNPAY K NG NH DNG System.FormatException: Input string was not in a correct format.
   at System.Number.ThrowOverflowOrFormatException(ParsingStatus status, TypeCode type)
   at System.Convert.ToInt32(String value)
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
2023-11-28 17:30:21.857 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:30:21.857 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 4934.4984ms
2023-11-28 17:30:21.857 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:30:21.857 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 400 - application/json;+charset=utf-8 4934.9240ms
2023-11-28 17:30:37.329 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513
2023-11-28 17:30:37.329 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:30:37.329 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:30:37.329 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:30:41.427 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:30:41.427 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:30:41.431 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:30:41.437 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:30:43.750 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@__request_MerchantCode_0='?' (Size = 50), @__request_TerminalId_1='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[UrlCreateQR]
FROM [QRPay.Terminals] AS [q]
WHERE (([q].[PaymentType] = N'VNPay') AND ([q].[MasterMerchant] = @__request_MerchantCode_0)) AND ([q].[AccessCode] = @__request_TerminalId_1)
2023-11-28 17:30:45.188 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TerminalId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [QRPay.Terminals] AS [q]
        WHERE [q].[TerminalCode] = @__request_TerminalId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2023-11-28 17:30:54.587 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:30:54.593 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p20='?' (DbType = Int64), @p0='?' (DbType = Double), @p1='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?' (Size = 200), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 50), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 500), @p12='?' (Size = 50), @p13='?' (Size = 200), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Size = 200), @p17='?' (DbType = Int32), @p18='?' (Size = 50), @p19='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [Amount] = @p0, [BookId] = @p1, [CompanyId] = @p2, [CustomerName] = @p3, [DateCreateQR] = @p4, [DatePay] = @p5, [DriverCode] = @p6, [DriverName] = @p7, [ErrorCode] = @p8, [ExpiredFee] = @p9, [FeeMonth] = @p10, [Message] = @p11, [Mobile] = @p12, [PartnerTransId] = @p13, [PaymentType] = @p14, [PrivateCode] = @p15, [QRCode] = @p16, [Status] = @p17, [TripId] = @p18, [VehiclePlate] = @p19
WHERE [TransId] = @p20;
SELECT @@ROWCOUNT;
2023-11-28 17:30:54.597 +07:00  ERR  Li Update Tran VNPAY K NG NH DNG System.FormatException: Input string was not in a correct format.
   at System.Number.ThrowOverflowOrFormatException(ParsingStatus status, TypeCode type)
   at System.Convert.ToInt32(String value)
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
2023-11-28 17:30:54.597 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:30:54.597 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 17267.6195ms
2023-11-28 17:30:54.597 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:30:54.597 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 513 - 400 - application/json;+charset=utf-8 17268.0551ms
2023-11-28 17:32:10.714 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516
2023-11-28 17:32:10.715 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:32:10.715 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:32:10.715 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:32:14.083 +07:00  INF  Current Checksum 4d9d142c0d07180d8a034c7acfd30c3d FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0311609355|cjNaVAhET34Oysae
2023-11-28 17:32:14.084 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:32:14.089 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:32:14.097 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:32:15.186 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_MerchantCode_0='?' (Size = 50), @__request_TerminalId_1='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[UrlCreateQR]
FROM [QRPay.Terminals] AS [q]
WHERE (([q].[PaymentType] = N'VNPay') AND ([q].[MasterMerchant] = @__request_MerchantCode_0)) AND ([q].[AccessCode] = @__request_TerminalId_1)
2023-11-28 17:32:15.418 +07:00  INF  Executed DbCommand (10ms) [Parameters=[@__request_TerminalId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [QRPay.Terminals] AS [q]
        WHERE [q].[TerminalCode] = @__request_TerminalId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2023-11-28 17:32:19.683 +07:00  INF  Executed DbCommand (10ms) [Parameters=[@__request_TerminalId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[Id], [q].[AccessCode], [q].[CompanyId], [q].[DriverCode], [q].[DriverName], [q].[HashCode], [q].[MasterMerchant], [q].[MerchantCode], [q].[MerchantName], [q].[MerchantType], [q].[Password], [q].[PathImage], [q].[PaymentType], [q].[TerminalCode], [q].[TerminalName], [q].[TerminalType], [q].[UrlCreateQR], [q].[UrlDriverCompany], [q].[UrlGetToken], [q].[UserName]
FROM [QRPay.Terminals] AS [q]
WHERE [q].[TerminalCode] = @__request_TerminalId_0
2023-11-28 17:32:53.460 +07:00  INF  Update trans static Comp 184 dvCode  amount 78520000
2023-11-28 17:34:38.468 +07:00  ERR  Li Update Tran VNPAY LogETran
2023-11-28 17:34:38.469 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:34:38.475 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 147760.4091ms
2023-11-28 17:34:38.476 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:34:38.478 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516 - 400 - application/json;+charset=utf-8 147763.4661ms
2023-11-28 17:34:42.332 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516
2023-11-28 17:34:42.333 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:34:42.333 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:34:42.333 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:34:44.505 +07:00  INF  Current Checksum 78bf6bd0cdbbc5e63a14034ba60350fe FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:34:44.505 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:34:44.509 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:34:44.510 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:34:44.515 +07:00  INF  Executed DbCommand (2ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:34:45.462 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:34:47.118 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 4785.4995ms
2023-11-28 17:34:47.118 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:34:47.118 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516 - 200 - application/json;+charset=utf-8 4786.0025ms
2023-11-28 17:34:51.372 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516
2023-11-28 17:34:51.372 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:34:51.372 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:34:51.372 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:34:55.036 +07:00  INF  Current Checksum 78bf6bd0cdbbc5e63a14034ba60350fe FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:34:55.036 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:34:55.082 +07:00  INF  Executed DbCommand (46ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:34:55.083 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:34:55.090 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:34:57.384 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:35:00.009 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 8636.6695ms
2023-11-28 17:35:00.009 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:35:00.009 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516 - 200 - application/json;+charset=utf-8 8637.3944ms
2023-11-28 17:35:13.908 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516
2023-11-28 17:35:13.908 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:35:13.908 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:35:13.908 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:35:26.345 +07:00  INF  Current Checksum 78bf6bd0cdbbc5e63a14034ba60350fe FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:35:26.345 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:35:26.351 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:35:26.351 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"LONGAYUASN","amount":"78520000"}}
2023-11-28 17:35:26.358 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:35:26.362 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:35:26.362 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 12453.6347ms
2023-11-28 17:35:26.362 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:35:26.362 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516 - 200 - application/json;+charset=utf-8 12454.1023ms
2023-11-28 17:35:29.518 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516
2023-11-28 17:35:29.519 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:35:29.519 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:35:29.519 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:35:34.030 +07:00  INF  Current Checksum 78bf6bd0cdbbc5e63a14034ba60350fe FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:35:34.030 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:35:34.035 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:35:34.041 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:35:34.053 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_MerchantCode_0='?' (Size = 50), @__request_TerminalId_1='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[UrlCreateQR]
FROM [QRPay.Terminals] AS [q]
WHERE (([q].[PaymentType] = N'VNPay') AND ([q].[MasterMerchant] = @__request_MerchantCode_0)) AND ([q].[AccessCode] = @__request_TerminalId_1)
2023-11-28 17:35:34.056 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TerminalId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [QRPay.Terminals] AS [q]
        WHERE [q].[TerminalCode] = @__request_TerminalId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2023-11-28 17:35:34.085 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:35:34.094 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@p20='?' (DbType = Int64), @p0='?' (DbType = Double), @p1='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?' (Size = 200), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 50), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 500), @p12='?' (Size = 50), @p13='?' (Size = 200), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Size = 200), @p17='?' (DbType = Int32), @p18='?' (Size = 50), @p19='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [Amount] = @p0, [BookId] = @p1, [CompanyId] = @p2, [CustomerName] = @p3, [DateCreateQR] = @p4, [DatePay] = @p5, [DriverCode] = @p6, [DriverName] = @p7, [ErrorCode] = @p8, [ExpiredFee] = @p9, [FeeMonth] = @p10, [Message] = @p11, [Mobile] = @p12, [PartnerTransId] = @p13, [PaymentType] = @p14, [PrivateCode] = @p15, [QRCode] = @p16, [Status] = @p17, [TripId] = @p18, [VehiclePlate] = @p19
WHERE [TransId] = @p20;
SELECT @@ROWCOUNT;
2023-11-28 17:35:34.099 +07:00  ERR  Li Update Tran VNPAY K NG NH DNG System.FormatException: Input string was not in a correct format.
   at System.Number.ThrowOverflowOrFormatException(ParsingStatus status, TypeCode type)
   at System.Convert.ToInt32(String value)
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
2023-11-28 17:35:34.099 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:35:34.099 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 4580.254ms
2023-11-28 17:35:34.099 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:35:34.099 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516 - 400 - application/json;+charset=utf-8 4580.6401ms
2023-11-28 17:35:43.271 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516
2023-11-28 17:35:43.271 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:35:43.271 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:35:43.271 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:43:24.331 +07:00  INF  Current Checksum 78bf6bd0cdbbc5e63a14034ba60350fe FromString 00|1|LONGAYUASN|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:43:24.360 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:43:24.391 +07:00  INF  Executed DbCommand (5ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:43:24.406 +07:00  INF  Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:43:28.881 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_MerchantCode_0='?' (Size = 50), @__request_TerminalId_1='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[UrlCreateQR]
FROM [QRPay.Terminals] AS [q]
WHERE (([q].[PaymentType] = N'VNPay') AND ([q].[MasterMerchant] = @__request_MerchantCode_0)) AND ([q].[AccessCode] = @__request_TerminalId_1)
2023-11-28 17:43:30.692 +07:00  INF  Executed DbCommand (11ms) [Parameters=[@__request_TerminalId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [QRPay.Terminals] AS [q]
        WHERE [q].[TerminalCode] = @__request_TerminalId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2023-11-28 17:44:25.410 +07:00  INF  Executed DbCommand (9ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:44:25.418 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@p20='?' (DbType = Int64), @p0='?' (DbType = Double), @p1='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?' (Size = 200), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (Size = 50), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (DbType = DateTime), @p10='?' (DbType = DateTime), @p11='?' (Size = 500), @p12='?' (Size = 50), @p13='?' (Size = 200), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Size = 200), @p17='?' (DbType = Int32), @p18='?' (Size = 50), @p19='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [Amount] = @p0, [BookId] = @p1, [CompanyId] = @p2, [CustomerName] = @p3, [DateCreateQR] = @p4, [DatePay] = @p5, [DriverCode] = @p6, [DriverName] = @p7, [ErrorCode] = @p8, [ExpiredFee] = @p9, [FeeMonth] = @p10, [Message] = @p11, [Mobile] = @p12, [PartnerTransId] = @p13, [PaymentType] = @p14, [PrivateCode] = @p15, [QRCode] = @p16, [Status] = @p17, [TripId] = @p18, [VehiclePlate] = @p19
WHERE [TransId] = @p20;
SELECT @@ROWCOUNT;
2023-11-28 17:44:25.422 +07:00  ERR  Li Update Tran VNPAY K NG NH DNG System.FormatException: Input string was not in a correct format.
   at System.Number.ThrowOverflowOrFormatException(ParsingStatus status, TypeCode type)
   at System.Convert.ToInt32(String value)
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
2023-11-28 17:44:25.422 +07:00  INF  Executing BadRequestObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:44:25.423 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 522151.3502ms
2023-11-28 17:44:25.423 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:44:25.423 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 516 - 400 - application/json;+charset=utf-8 522151.7493ms
2023-11-28 17:44:28.548 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510
2023-11-28 17:44:28.548 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:44:28.548 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:44:28.548 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:44:30.523 +07:00  INF  Current Checksum a3d995d70e24f7351ea1aa6d4208226f FromString 00|1|1049|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:44:30.524 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:44:30.528 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:44:30.529 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"1049","amount":"78520000"}}
2023-11-28 17:44:33.236 +07:00  INF  Executed DbCommand (6ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:44:35.722 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 7173.5648ms
2023-11-28 17:44:35.722 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:44:35.723 +07:00  ERR  An unhandled exception has occurred while executing the request.System.NullReferenceException: Object reference not set to an instance of an object.
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
   at lambda_method367(Closure , Object , Object[] )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)

2023-11-28 17:44:35.724 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510 - 500 - text/plain;+charset=utf-8 7176.3933ms
2023-11-28 17:44:37.364 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510
2023-11-28 17:44:37.364 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:44:37.364 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:44:37.364 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:44:39.177 +07:00  INF  Current Checksum a3d995d70e24f7351ea1aa6d4208226f FromString 00|1|1049|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:44:39.178 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:44:39.185 +07:00  INF  Executed DbCommand (7ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:44:39.185 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"1049","amount":"78520000"}}
2023-11-28 17:44:41.901 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:44:43.289 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 5925.4944ms
2023-11-28 17:44:43.290 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:44:43.291 +07:00  ERR  An unhandled exception has occurred while executing the request.System.NullReferenceException: Object reference not set to an instance of an object.
   at Payment.App.Controllers.VnPayController.MerchantPayment(MerchantRequest request)
   at lambda_method367(Closure , Object , Object[] )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)

2023-11-28 17:44:43.292 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510 - 500 - text/plain;+charset=utf-8 5928.4811ms
2023-11-28 17:45:07.726 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510
2023-11-28 17:45:07.727 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:45:07.727 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:45:07.727 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:45:09.537 +07:00  INF  Current Checksum a3d995d70e24f7351ea1aa6d4208226f FromString 00|1|1049|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:45:09.537 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:45:09.541 +07:00  INF  Executed DbCommand (4ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:45:09.542 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"1049","amount":"78520000"}}
2023-11-28 17:45:09.546 +07:00  INF  Executed DbCommand (2ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:45:11.887 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:45:13.446 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 5719.1822ms
2023-11-28 17:45:13.446 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:45:13.446 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510 - 200 - application/json;+charset=utf-8 5719.7459ms
2023-11-28 17:45:20.557 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510
2023-11-28 17:45:20.557 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:45:20.557 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:45:20.558 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:45:42.128 +07:00  INF  Current Checksum a3d995d70e24f7351ea1aa6d4208226f FromString 00|1|1049|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:45:42.142 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:45:42.148 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:45:42.148 +07:00  ERR  RES {"code":"06","message":"Sai th\u00F4ng tin x\u00E1c th\u1EF1c","data":{"txnId":"1049","amount":"78520000"}}
2023-11-28 17:45:42.154 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:45:42.159 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:45:42.159 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 21601.2415ms
2023-11-28 17:45:42.159 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:45:42.159 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510 - 200 - application/json;+charset=utf-8 21601.6977ms
2023-11-28 17:45:46.661 +07:00  INF  Request starting HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510
2023-11-28 17:45:46.662 +07:00  INF  No CORS policy found for the specified request.
2023-11-28 17:45:46.662 +07:00  INF  Executing endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:45:46.662 +07:00  INF  Route matched with {action = "MerchantPayment", controller = "VnPay"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult MerchantPayment(Payment.App.Models.VnPay.MerchantRequest) on controller Payment.App.Controllers.VnPayController (Payment.App).
2023-11-28 17:45:49.617 +07:00  INF  Current Checksum a3d995d70e24f7351ea1aa6d4208226f FromString 00|1|1049|000098469|VCB|0989511021|string|78520000|20180807164732|0102306702|cjNaVAhET34Oysae
2023-11-28 17:45:50.927 +07:00  INF  Entity Framework Core 6.0.23 initialized 'PaymentDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.23' with options: None
2023-11-28 17:45:50.931 +07:00  INF  Executed DbCommand (3ms) [Parameters=[@__request_TxnId_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [q].[TransId], [q].[Amount], [q].[BookId], [q].[CompanyId], [q].[CustomerName], [q].[DateCreateQR], [q].[DatePay], [q].[DriverCode], [q].[DriverName], [q].[ErrorCode], [q].[ExpiredFee], [q].[FeeMonth], [q].[Message], [q].[Mobile], [q].[PartnerTransId], [q].[PaymentType], [q].[PrivateCode], [q].[QRCode], [q].[Status], [q].[TripId], [q].[VehiclePlate]
FROM [QRPay.Transaction] AS [q]
WHERE [q].[TripId] = @__request_TxnId_0
2023-11-28 17:45:57.823 +07:00  ERR  RES {"code":"09","message":"QR h\u1EBFt h\u1EA1n thanh to\u00E1n","data":{"txnId":null,"amount":"78520000"}}
2023-11-28 17:45:57.843 +07:00  INF  Executed DbCommand (14ms) [Parameters=[@p2='?' (DbType = Int64), @p0='?' (DbType = Int32), @p1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [QRPay.Transaction] SET [ErrorCode] = @p0, [Message] = @p1
WHERE [TransId] = @p2;
SELECT @@ROWCOUNT;
2023-11-28 17:45:57.858 +07:00  INF  Executing OkObjectResult, writing value of type 'Payment.App.Models.VnPay.MerchantResponse'.
2023-11-28 17:45:57.859 +07:00  INF  Executed action Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App) in 11196.8386ms
2023-11-28 17:45:57.859 +07:00  INF  Executed endpoint 'Payment.App.Controllers.VnPayController.MerchantPayment (Payment.App)'
2023-11-28 17:45:57.859 +07:00  INF  Request finished HTTP/2 POST https://localhost:7116/api/VnPay/MerchantPayment application/json 510 - 200 - application/json;+charset=utf-8 11197.4294ms
